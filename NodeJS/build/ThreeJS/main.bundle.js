!function(e){var t={};function n(o){if(t[o])return t[o].exports;var a=t[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(o,a,function(t){return e[t]}.bind(null,a));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(e,t,n){e.exports=n(1)(0)},function(e,t){e.exports=vendor_3e8f60c42333e5aa2739},function(e,t,n){e.exports=n(1)(5)},function(e,t,n){e.exports=n(1)(4)},function(e,t,n){e.exports=function(){"use strict";var e=function(){var t=0,n=document.createElement("div");function o(e){return n.appendChild(e.dom),e}function a(e){for(var o=0;o<n.children.length;o++)n.children[o].style.display=o===e?"block":"none";t=e}n.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",n.addEventListener("click",function(e){e.preventDefault(),a(++t%n.children.length)},!1);var i=(performance||Date).now(),r=i,s=0,d=o(new e.Panel("FPS","#0ff","#002")),l=o(new e.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var u=o(new e.Panel("MB","#f08","#201"));return a(0),{REVISION:16,dom:n,addPanel:o,showPanel:a,begin:function(){i=(performance||Date).now()},end:function(){s++;var e=(performance||Date).now();if(l.update(e-i,200),r+1e3<=e&&(d.update(1e3*s/(e-r),100),r=e,s=0,u)){var t=performance.memory;u.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){i=this.end()},domElement:n,setMode:a}};return e.Panel=function(e,t,n){var o=1/0,a=0,i=Math.round,r=i(window.devicePixelRatio||1),s=80*r,d=48*r,l=3*r,u=2*r,c=3*r,p=15*r,f=74*r,y=30*r,h=document.createElement("canvas");h.width=s,h.height=d,h.style.cssText="width:80px;height:48px";var m=h.getContext("2d");return m.font="bold "+9*r+"px Helvetica,Arial,sans-serif",m.textBaseline="top",m.fillStyle=n,m.fillRect(0,0,s,d),m.fillStyle=t,m.fillText(e,l,u),m.fillRect(c,p,f,y),m.fillStyle=n,m.globalAlpha=.9,m.fillRect(c,p,f,y),{dom:h,update:function(d,v){o=Math.min(o,d),a=Math.max(a,d),m.fillStyle=n,m.globalAlpha=1,m.fillRect(0,0,s,p),m.fillStyle=t,m.fillText(i(d)+" "+e+" ("+i(o)+"-"+i(a)+")",l,u),m.drawImage(h,c+r,p,f-r,y,c,p,f-r,y),m.fillRect(c+f-r,p,r,y),m.fillStyle=n,m.globalAlpha=.9,m.fillRect(c+f-r,p,r,i((1-d/v)*y))}}},e}()},function(e,t,n){"use strict";n.r(t);var o=n(0),a=(n(3),n(4)),i=n.n(a),r=function e(){document.addEventListener("keydown",e.onKeyDown,!1),document.addEventListener("keyup",e.onKeyUp,!1)};r.k={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete",186:";",187:"=",188:",",189:"-",190:".",191:"/",219:"[",220:"\\",221:"]",222:"'"},r.status={},r.keyName=function(e){return null!=r.k[e]?r.k[e]:String.fromCharCode(e)},r.onKeyUp=function(e){e.preventDefault();var t=r.keyName(e.keyCode);r.status[t]&&(r.status[t].pressed=!1)},r.onKeyDown=function(e){e.preventDefault();var t=r.keyName(e.keyCode);r.status[t]||(r.status[t]={down:!1,pressed:!1,up:!1,updatedPreviously:!1})},r.prototype.update=function(){for(var e in r.status)r.status[e].updatedPreviously?r.status[e].down=!1:(r.status[e].down=!0,r.status[e].pressed=!0,r.status[e].updatedPreviously=!0),r.status[e].up?delete r.status[e]:r.status[e].pressed||(r.status[e].up=!0)},r.prototype.down=function(e){return r.status[e]&&r.status[e].down},r.prototype.pressed=function(e){return r.status[e]&&r.status[e].pressed},r.prototype.up=function(e){return r.status[e]&&r.status[e].up},r.prototype.debug=function(){var e="Keys active: ";for(var t in r.status)e+=" "+t;console.log(e)};var s,d,l=r;var u=n(2);function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var p,f,y,h,m,v,w=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0,z:0},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.pos=new o.Vector3(n.x,n.y,n.z),this.angle=a,this.speed=0,this.body=this.buildBody(t),this.text=new u.SpriteText2D(t,{align:u.textAlign.center,font:"40px Arial",fillStyle:"#ff0000"}),this.text.scale.set(.2,.2,.2),this.text.position.y=10,this.body.add(this.text),this.body.position.copy(this.pos),this.body.rotation.y=a}var t,n,a;return t=e,(n=[{key:"buildBody",value:function(){var e=new o.Object3D,t=new o.Mesh(new o.CylinderGeometry(10,10,6,64),new o.MeshNormalMaterial),n=new o.Mesh(new o.BoxGeometry(10,6,3),new o.MeshNormalMaterial);return n.position.set(10,0,0),e.add(t,n),e}},{key:"update",value:function(e){d.pressed("W")&&(this.speed+=.5),d.pressed("S")&&(this.speed-=.5),d.pressed("A")&&(this.angle+=.1),d.pressed("D")&&(this.angle-=.1),this.speed=Math.max(0,Math.min(this.speed,70)),this.pos.add(new o.Vector3(this.speed*e,0,0).applyAxisAngle(new o.Vector3(0,1,0),this.angle))}},{key:"updateByServer",value:function(e,t){this.angle=t,this.pos.set(e.x,e.y,e.z),this.body.position.copy(this.pos),this.body.rotation.y=this.angle}},{key:"addToScene",value:function(){s.add(this.body)}},{key:"removeToScene",value:function(){s.remove(this.body)}}])&&c(t.prototype,n),a&&c(t,a),e}(),g=[];window.addEventListener("resize",function(){var e=window.innerWidth,t=window.innerHeight;m.aspect=e/t,m.updateProjectionMatrix(),h.setSize(e,t)},!1),s=new o.Scene,d=new l,p=parent.socket,v=new o.Clock,(y=new i.a).domElement.style.position="absolute",y.domElement.style.top="0px",y.domElement.style.zIndex=100,document.body.appendChild(y.domElement),(h=new o.WebGLRenderer).setSize(window.innerWidth,window.innerHeight),h.setClearColor(8947848),document.body.appendChild(h.domElement),s.add(new o.GridHelper(500,50,"red","white")),f=new w(parent.account),(m=new o.PerspectiveCamera(35,window.innerWidth/window.innerHeight,1,1e3)).position.set(-50,10,0),m.lookAt(new o.Vector3),p.emit("init",{account:parent.account,pos:f.pos,angle:f.angle},function(e){var t=0;e.forEach(function(e){e?(g[t]=new w(e.name,e.state.pos,e.state.angle),g[t].addToScene(),g[t].name===parent.account&&(g[t].body.remove(g[t].text),g[t].body.add(m))):g[t]=void 0,t++})}),function e(){d.update();y.update();var t=v.getDelta();f.update(t);var n=0;p.emit("clientUpdate",{account:parent.account,pos:f.pos,angle:f.angle},function(e){e.forEach(function(e){e?void 0===g[n]?(g[n]=new w(e.name,e.state.pos,e.state.angle),g[n].addToScene()):g[n].updateByServer(e.state.pos,e.state.angle):g[n]&&(g[n].removeToScene(),g[n]=void 0),n++})});requestAnimationFrame(e);h.render(s,m)}()}]);
//# sourceMappingURL=main.bundle.js.map