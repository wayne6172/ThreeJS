<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Testing</title>
    <style>
        body {
            overflow: hidden
        }
    </style>
</head>
<body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/96/three.min.js"></script>
    <script src="https://threejs.org/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/stats.js/r16/Stats.min.js"></script>
    <script src="https://rawgit.com/jyunming-chen/tutsplus/master/js/text2D.js"></script>

    <script>
        var camera, scene, renderer, stats, control, loader;
        var body, googleMap, map, mapDetail = [
            {position: new THREE.Vector3(-700,0,-90), width: 0.8, rotation: Math.PI / 180 * -12},
            {position: new THREE.Vector3(-790,0,1250), width: 1.0, rotation: 0},
            {position: new THREE.Vector3(-135,0,-55), width: 3.0, rotation: 0},
            {position: new THREE.Vector3(-135,0,305), width: 3.0, rotation: 0},
            {position: new THREE.Vector3(-145,0,585), width: 3.1, rotation: Math.PI / 180 * -0.5},
            {position: new THREE.Vector3(-155,0,875), width: 3.15, rotation: Math.PI / 180 * -0.5},
            {position: new THREE.Vector3(-155,0,1255), width: 3.15, rotation: Math.PI / 180 * -0.5},
            {position: new THREE.Vector3(750,0,305), width: 3.0, rotation: 0},
            {position: new THREE.Vector3(750,0,590), width: 3.0, rotation: Math.PI / 180 * -0.5},
            {position: new THREE.Vector3(750,0,885), width: 3.0, rotation: Math.PI / 180 * -0.5},
            {position: new THREE.Vector3(750,0,1265), width: 3.0, rotation: Math.PI / 180 * -0.5},
            {position: new THREE.Vector3(305,0,-205), width: 0.9, rotation: Math.PI / 2},
            {position: new THREE.Vector3(-100,0,-350), width: 2.7, rotation: 0},
            {position: new THREE.Vector3(305,0,-485), width: 0.8, rotation: Math.PI / 2},
            {position: new THREE.Vector3(-70,0,-620), width: 2.5, rotation: 0},
            {position: new THREE.Vector3(305,0,-785), width: 1.0, rotation: Math.PI / 2},
            {position: new THREE.Vector3(445,0,-1085), width: 0.9, rotation: Math.PI / 3},
            {position: new THREE.Vector3(750,0,-620), width: 3.0, rotation: 0},
            {position: new THREE.Vector3(750,0,-950), width: 3.0, rotation: 0},
            {position: new THREE.Vector3(-40,0,-950), width: 2.3, rotation: 0},
            {position: new THREE.Vector3(-480,0,-980), width: 0.8, rotation: Math.PI / 180 * -23},
            {position: new THREE.Vector3(750,0,-350), width: 3.0, rotation: 0},
            {position: new THREE.Vector3(750,0,-55), width: 3.0, rotation: 0},
            {position: new THREE.Vector3(305,0,125), width: 1.1, rotation: Math.PI / 2},
            {position: new THREE.Vector3(305,0,445), width: 0.9, rotation: Math.PI / 2},
            {position: new THREE.Vector3(305,0,735), width: 0.9, rotation: Math.PI / 2},
            {position: new THREE.Vector3(305,0,1075), width: 1.2, rotation: Math.PI / 2},
            {position: new THREE.Vector3(1195,0,30), width: 8.7, rotation: Math.PI / 2},
            {position: new THREE.Vector3(-600,0,600), width: 4.5, rotation: Math.PI / 180 * 88},
            {position: new THREE.Vector3(-470,0,-500), width: 3.0, rotation: Math.PI / 180 * 76.5},
            {position: new THREE.Vector3(50,0,-1205), width: 8.0, rotation: 0},
        ];

        init();
        animate();

        function buildRoad(){
            var map = new THREE.Object3D(),road;
            var roadTexture = loader.load('texture/Road.jpg');
            var bigRoadTexture = loader.load('texture/BigRoad.jpg');
            bigRoadTexture.wrapS = THREE.RepeatWrapping;
            bigRoadTexture.repeat.set(5,1);

            for(var i = 0;i < mapDetail.length; i++){
                road = new THREE.Mesh(new THREE.PlaneGeometry(280 * mapDetail[i].width,187 * 0.4),new THREE.MeshBasicMaterial({map: roadTexture}));
                road.rotation.x = -Math.PI / 2;
                road.rotation.z = mapDetail[i].rotation;
                road.position.copy(mapDetail[i].position);
                map.add(road);
            }
            road = new THREE.Mesh(new THREE.PlaneGeometry(223 * 6,280),new THREE.MeshBasicMaterial({map: bigRoadTexture}));
            road.rotation.x = -Math.PI / 2;
            road.rotation.z = Math.PI / 180 * 85;
            road.position.set(-1000,0,560);
            map.add(road);

            road = new THREE.Mesh(new THREE.PlaneGeometry(223 * 4.5,280),new THREE.MeshBasicMaterial({map: bigRoadTexture}));
            road.rotation.x = -Math.PI / 2;
            road.rotation.z = Math.PI / 180 * 77;
            road.position.set(-830,0,-660);
            map.add(road);

            return map;
        }

        function init() {
            scene = new THREE.Scene();
            clock = new THREE.Clock();
            stats = new Stats();
            stats.domElement.style.position = 'absolute';
            stats.domElement.style.top = '0px';

            stats.domElement.style.zIndex = 100;
            document.body.appendChild(stats.domElement);

            camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 1, 10000);
            camera.position.set(50,50,50);
            camera.lookAt(new THREE.Vector3());


            renderer = new THREE.WebGLRenderer();
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setClearColor(0x888888);

            control = new THREE.OrbitControls(camera,renderer.domElement);
            control.enableKeys = false;

            document.body.appendChild(renderer.domElement);

            //--------------遊戲區初始化--------------------//

            body = new THREE.Mesh(new THREE.BoxGeometry(40,10,15),new THREE.MeshNormalMaterial());
            scene.add(body);

            loader = new THREE.TextureLoader();
            loader.crossOrigin = '';
            googleMap = new THREE.Mesh(new THREE.PlaneGeometry(826 * 3,873 * 3),new THREE.MeshBasicMaterial({map: loader.load('texture/Map(826x873).png')}));
            googleMap.rotation.x = -Math.PI / 2;
            googleMap.position.y = -0.2;

            map = buildRoad();
            scene.add(googleMap,map);
        }

        function animate() {
            stats.update();

            requestAnimationFrame(animate);
            render();
        }

        function render() {
            renderer.render(scene,camera);
        }


    </script>
</body>
</html>